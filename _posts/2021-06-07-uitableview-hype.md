---
layout: post
title: "UITableView를 쓰지 말아야할 때"
categories: []
tags:
- UITableView
- UIStackView
type: post
published: true
meta: {}
---

UITableView는 당연히 사용할 줄 알아야 하는 필수적인 클래스인만큼 잘못 사용되는 경우도 잦은 클래스다. 컨텐츠가 화면에 다 담기지 않아 스크롤이 발생하는 레이아웃을 만들어야할 때 별 고민없이 테이블뷰가 사용되는 상황을 많이 봤다. 심지어 스크롤이 발생하지 않더라도 단지 같은 뷰가 여러번 반복된다는 이유로 테이블뷰를 사용하기도 한다. 하지만 테이블뷰를 사용하기로 쉽게 결정하기 전에, 정말 뷰를 재사용하는 컴포넌트가 필요한지 짚어봐야 한다.

### 테이블뷰의 장점: 구조화된 데이터 표현 및 메모리 효율

테이블뷰는 데이터가 일관된 구조를 가지고 있고 계층화되어 있을 때 가장 유용하다. iOS의 설정 앱이나 연락처 앱이 대표적인 예시다. 내비게이션 뷰컨트롤러와 함께 사용하면 계층적인 구조를 정말 잘 나타낼 수 있다. 그리고 뷰(`UITableViewCell`)를 재사용하기 때문에 보여줘야 할 데이터가 수 백, 수 천 개여도 화면을 채울 만큼만 인스턴스가 만들어지기 때문에 데이터의 사이즈가 커도 메모리 걱정을 하지 않아도 된다.

### 테이블뷰의 단점: 복잡한 코드 + ⍺

프로그래밍과 관련된 거의 모든 결정에는 트레이드오프가 발생하는 거처럼, 테이블뷰도 뚜렷한 단점이 있다. 뷰 인스턴스를 재사용하는 장점을 얻는 대신 **구조가 더 복잡해지고 코드가 길어지고 버그에 취약해진다**.

UITableView를 설정해주고, UITableViewCell을 상속하고, DataSource와 Delegate를 구현해야 한다. 또한 셀 인스턴스가 재사용되면서 발생할 수 있는 이상한 동작을 방지하기 위해 추가되는 코드가 소소하지만 꽤 많다. 셀에 필요한 UI 데이터(이미지 등)를 비동기로 불러와야 경우, 외부의 사건(유저 액션 등)으로 인해 셀의 UI가 바뀌어야 하는 경우 등등에 추가적인 검사 로직을 넣어줘야 한다. 게다가 뷰의 레이아웃이나 크기를 동적으로 바꾸거나 애니메이션을 넣는 간단한 일도 테이블뷰가 연관되면 잘 안되고 귀찮아질 때가 많다.

### 테이블뷰 필요없는 경우 🔴

글의 시작 부분에서 언급한 오용이란 장점을 제대로 누리지 못하는 상황을 말한다. 대표적으로 셀이 재사용될 필요가 거의 없거나 재사용이 안되는 경우다. 테이블 열의 갯수가 적으면 메모리 걱정을 할 필요가 없다. 또한 테이블뷰의 열이 10개인데 10개가 다 다른 종류의 셀이라면 아무것도 재사용되지 않는다. 굳이 테이블뷰를 쓸 이유가 없다.

### 테이블뷰 필요한 경우 🟢

반대로 테이블뷰를 꼭 써야하는 경우는 **데이터가 많을 때다**. '많다'를 판별하는 절대 기준이 있는건 아니다. 하지만 너무 보수적으로 잡을 필요는 없다고 생각한다. 

### 고민이 필요한 경우 🟠

개발하다보면 중간지대의 상황도 자주 맞닥뜨린다. 데이터는 적당히 많으면서 셀 종류도 두어개, 많게는 10개 정도. 유저 인터랙션도 있고 그에 따른 상태 변화와 UI 변화도 있는 경우. 그럴땐 뷰 재사용이 꼭 필요한지, 아니면 간단하고 안전한 코드가 더 이득일지 판단을 내려야 한다. 경험적으로 두 페이지가 넘어가지 않는 경우나, 필요한 뷰들을 한꺼번에 생성해도 메인쓰레드가 블락되지 않는 정도라면 간결한 코드의 장점이 더 크다.

### 대안: UIStackView + UIScrollView

뷰 재사용이 필수적인 요구사항이 아니라면 스택뷰 단독이나 스택뷰+스크롤뷰 조합을 이용해 훨씬 간결한 코드로 UI를 만들수 있다. 이 방식은 뷰를 직접 참조하여 들고 있을 수 있어서 언제든 간단하게 변화를 줄수도 있고, 테이블뷰처럼 의무적으로 호출해야 하는 메서드도 없어서 실수도 덜하고 디버깅도 쉽다.
